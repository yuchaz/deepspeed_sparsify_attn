Modifed from https://github.com/microsoft/DeepSpeed.git hash fa8d6c0a540b442efe8f2249416cc5e098663482
